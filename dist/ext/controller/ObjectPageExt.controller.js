sap.ui.define(["sap/m/MessageToast","sap/ui/comp/library","sap/ui/core/mvc/Controller","sap/ui/model/type/String","sap/m/ColumnListItem","sap/m/Label","sap/m/SearchField","sap/m/Token","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/odata/v2/ODataModel","sap/ui/table/Column","sap/m/Column","sap/m/Text"],function(e,t,a,r,n,o,s,i,l,g,u,c,p,d){"use strict";return{onInit:function(){var e=new sap.ui.model.json.JSONModel({items:[]});var t=[];var a={materialText:"",serialNumber:"",materialNumber:"",dayOwned:"",lastRecievedDate:"",userStatustext:""};t.push(JSON.parse(JSON.stringify(a)));this.getOwnerComponent().setModel(e,"item");this.getOwnerComponent().getModel("item").setProperty("/items",t);var r=new sap.ui.model.json.JSONModel({items1:[]});var n=[];var o={operation:"",operationtext:""};n.push(JSON.parse(JSON.stringify(o)));this.getOwnerComponent().setModel(r,"item1");this.getOwnerComponent().getModel("item1").setProperty("/items1",n);var s=sap.ui.getCore().packURL},CreateG:function(e){var t="00000000000"+e.getSource().getParent().getParent().getBindingContext().getObject().orderNumber;t=t.substr(t.length-12);var a=sap.ushell.Container.getService("CrossApplicationNavigation");var r=a.hrefForExternal({target:{semanticObject:"HandlingUnit",action:"enterGoodsReceiptForProductionOrder"},params:{"CAUFVD-AUFNR":t}});var n=window.location.href.split("#")[0]+r;sap.m.URLHelper.redirect(n,true)},createHU:function(e){var t=new sap.m.BusyDialog;const a=e;console.log(e);console.log(sap.ui.getCore().byId("packingapp.packingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_C_PACKING_APP--action::createHUButton").getMetadata());var r=e.getSource().getParent().getParent().getBindingContext().getObject().salesOrderType;var n=e.getSource().getParent().getParent().getBindingContext().getObject().salesOrder;var o=e.getSource().getParent().getParent().getBindingContext().getObject().customer;var s=e.getSource().getParent().getParent().getBindingContext().getObject().packCustomerType;var i=e.getSource().getParent().getParent().getBindingContext().getObject().packStockType;var l=e.getSource().getParent().getParent().getBindingContext().getObject().PackingInstObj;var g=e.getSource().getParent().getParent().getBindingContext().getObject().packagingMaterialCustr;var u=e.getSource().getParent().getParent().getBindingContext().getObject().plant;var c=e.getSource().getParent().getParent().getBindingContext().getObject().batch;var p=e.getSource().getParent().getParent().getBindingContext().getObject().StorLoc;var d=0;var m=e.getSource().getParent().getParent().getBindingContext().getObject();var f;var v=e;var b=e.getSource().getParent().getParent().getBindingContext().getObject().packagingMaterialObj;var P=e.getSource().getParent().getParent().getBindingContext().getObject().PackingInstQuantObj;if(l==e.getSource().getParent().getParent().getBindingContext().getObject().packInstru){f=e.getSource().getParent().getParent().getBindingContext().getObject().packInstructionsKey}else if(l==e.getSource().getParent().getParent().getBindingContext().getObject().PackingCustomerInstructions){f=e.getSource().getParent().getParent().getBindingContext().getObject().packInstructionsCustKey}else{f=e.getSource().getParent().getParent().getBindingContext().getObject().altPIKey}var S="000000000000000000"+e.getSource().getParent().getParent().getBindingContext().getObject().product;S=S.substr(S.length-18);var h="000000000000000000"+e.getSource().getParent().getParent().getBindingContext().getObject().auxPackMaterialObj;h=h.substr(h.length-18);var O="00000000000"+e.getSource().getParent().getParent().getBindingContext().getObject().orderNumber;var C=e.getSource().getParent().getParent().getBindingContext().getObject().carrier;O=O.substr(O.length-12);var x;if(g==m.packagingMaterialObj){x=s}else if(b==m.packagingMaterialObj){x=i}b="000000000000000000"+b;b=b.substr(b.length-18);var M=this;if(x=="0004"){var w=e;var D=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/API_SALES_ORDER_SRV");var F=new Array;var B=new sap.ui.model.Filter({path:"SalesOrder",operator:sap.ui.model.FilterOperator.EQ,value1:n});F.push(B);var B=new sap.ui.model.Filter({path:"ZZ1_RFPRequired_SDH",operator:sap.ui.model.FilterOperator.EQ,value1:true});F.push(B);D.read("/A_SalesOrder",{filters:F,success:function(e,a){console.log(e.results);var r=0;var n="";if(e.results.length>0){if(e.results[0].ZZ1_RFPStatus_SDH!=undefined){if(e.results[0].ZZ1_RFPStatus_SDH==103||e.results[0].ZZ1_RFPStatus_SDH==104){r=1}else{sap.m.MessageBox.error("RFP status is not Initial or Final, HU creation is not possible");t.close()}}else{sap.m.MessageBox.error("RFP status is not Initial or Final, HU creation is not possible");t.close()}}else{r=1}var o='{"items":[';if(r==1&&C!=null&&C!=""&&C!=0){var s=this.getView().getParent().getBindingContext().getObject();var i=s.stat6;var l=s.stat7;var g=s.stat8;var c=s.stat9;var p=[];var d="'and manufacturer eq '"+C+"'";var m=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PACKAPP_SRV");var f=new Array;var v=new sap.ui.model.Filter({path:"carrier",operator:sap.ui.model.FilterOperator.EQ,value1:C});f.push(v);m.read("/ZSCM_I_AltCarriers",{filters:f,success:function(e,t){var a=new Array;var n=new Array;var s=new sap.ui.model.Filter({path:"manufacturer",operator:sap.ui.model.FilterOperator.EQ,value1:C});a.push(s);if(e.results.length>0){for(let t=0;t<e.results.length;t++){var s=new sap.ui.model.Filter({path:"manufacturer",operator:sap.ui.model.FilterOperator.EQ,value1:e.results[t].idnumber});a.push(s)}}var n=new sap.ui.model.Filter(a,false);var d=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_CONTAINER_EMPTY_SRV");var m=new Array;var f=new sap.ui.model.Filter({path:"materialNumber",operator:sap.ui.model.FilterOperator.EQ,value1:b});m.push(f);var f=new sap.ui.model.Filter({path:"plant",operator:sap.ui.model.FilterOperator.EQ,value1:u});m.push(f);var f=new sap.ui.model.Filter({path:"manufacturer",operator:sap.ui.model.FilterOperator.EQ,value1:C});m.push(n);d.read("/ZSCM_CONTAINER_L4",{filters:m,urlParameters:{$top:"2000"},success:function(e,t){console.log("I am here");console.log(e.results.length);for(let t=0;t<e.results.length;t++){var a=e.results[t].serialNumber;if(p.includes(a)==false){p.push(a)}else{if(a==e.results[t].serialNumber&&e.results[t].checkstatus=="Y"){e.results.splice(t,1);t-=1}else if(a==e.results[t-1].serialNumber&&e.results[t-1].checkstatus=="Y"){e.results.splice(t-1,1);if(t>1){t-=2}else if(t==1){t=0}}else if(t+1<e.results.length){if(a==e.results[t+1].serialNumber&&e.results[t+1].checkstatus=="Y"){e.results.splice(t+1,1)}}}}var n=0;console.log(p.length);for(let t=0;t<p.length;t++){var s=0;var u=0;var d=0;var m=0;var f=e.results[t].materialText;var v=e.results[t].serialNumber;var b=e.results[t].materialNumber;var P=e.results[t].dayOwned;var S=new Date(e.results[t].lastRecievedDate);var h={year:"numeric",month:"long",day:"numeric"};var O=new Intl.DateTimeFormat("en-US",h).format(S);console.log(O);var C=O;var x=e.results[t].userStatustext;var w="";if(i!=""&&i!=null&&i!="FUM"){u+=1}else if(l!=""&&l!=null&&l!="FUM"){u+=1}else if(g!=""&&g!=null&&g!="FUM"){u+=1}else if(c!=""&&c!=null&&c!="FUM"){u+=1}if(x!=undefined){if(x.nodeValue!=undefined){x=x.nodeValue}}else{x=""}a=p[t];for(let t=0;t<e.results.length;t++){if(a==e.results[t].serialNumber&&e.results[t].userStatustext!=undefined){w+=e.results[t].userStatustext+" "}}for(let t=0;t<4;t++){for(let r=0;r<e.results.length;r++){if(a==e.results[r].serialNumber){var D=e.results[r].userStatCode;console.log("userStat:"+D);console.log("serial:"+a);if(D!=undefined){if(D.nodeValue!=undefined){D=D.nodeValue}}else{D=""}if(D=="UNU"){d=1}console.log("herreee:");console.log(D);if(D=="DPI"){if(t==0&&i!=""&&i!=null&&i!="FUM"){if(i==D||i=="FQ"){s+=1}}else if(t==1&&l!=""&&l!=null&&l!="FUM"){if(l==D||l=="FQ"){s+=1}}else if(t==2&&g!=""&&g!=null&&g!="FUM"){if(g==D||g=="FQ"){s+=1}}else if(t==3&&c!=""&&c!=null&&c!="FUM"){if(c==D||c=="FQ"){s+=1}}}else if(D=="FQ"){if(t==0&&i!=""&&i!=null&&i!="FUM"){if(i==D){s+=1}}else if(t==1&&l!=""&&l!=null&&l!="FUM"){if(l==D){s+=1}}else if(t==2&&g!=""&&g!=null&&g!="FUM"){if(g==D){s+=1}}else if(t==3&&c!=""&&c!=null&&c!="FUM"){console.log(c);if(c==D){s+=1}}}else if(D=="GP"){if(t==0&&i!=""&&i!=null&&i!="FUM"){if(i==D){s+=1}}else if(t==1&&l!=""&&l!=null&&l!="FUM"){if(l==D){s+=1}}else if(t==2&&g!=""&&g!=null&&g!="FUM"){if(g==D||g=="FUM"){s+=1}}else if(t==3&&c!=""&&c!=null&&c!="FUM"){console.log(c);if(c==D||c=="FUM"){s+=1}}}else if(D=="FUM"){if(t==0&&i!=""&&i!=null&&i!="FUM"){if(i=="GP"){s+=1}}else if(t==1&&l!=""&&l!=null&&l!="FUM"){if(l=="GP"){s+=1}}else if(t==2&&g!=""&&g!=null&&g!="FUM"){if(g=="GP"){s+=1}}else if(t==3&&c!=""&&c!=null&&c!="FUM"){console.log(c);if(c=="GP"){s+=1}}}}}}if(i==""&&l==""&&g==""&&c==""){s=1;u=1}console.log("addToList:"+s);console.log("gpFlag"+m);if(s>0&&d!=1){if(n>=1){o+=","}o+='{"materialText":"'+f+'","serialNumber":"'+a+'","materialNumber":"'+b+'","dayOwned":"'+P+'","lastRecievedDate":"'+C+'","userStatustext":"'+w+'"}';n+=1;console.log(o)}}o+="]}";if(r==1&&o.length>10){console.log("here");var F=JSON.parse(o);console.log(F);var B=new sap.ui.model.json.JSONModel;B.setDefaultBindingMode("OneWay");B.setData(F);console.log(M.getOwnerComponent().getModel("item"));M.getOwnerComponent().getModel("item").setData(F);console.log(M.getOwnerComponent().getModel("item"));M._DialogGenerate=sap.ui.xmlfragment("packingapp.packingapp.ext.fragment.CreateHUDialog",M);M.getView().addDependent(M._DialogGenerate);M._DialogGenerate.open()}},error:function(e){console.log(e)}})}})}else if(r==1&&(C==0||C==""||C==null)){var s=this.getView().getParent().getBindingContext().getObject();var i=s.stat6;var l=s.stat7;var g=s.stat8;var c=s.stat9;var p=[];var P=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_CONTAINER_EMPTY_SRV");var S=new Array;var h=new sap.ui.model.Filter({path:"materialNumber",operator:sap.ui.model.FilterOperator.EQ,value1:b});S.push(h);var h=new sap.ui.model.Filter({path:"plant",operator:sap.ui.model.FilterOperator.EQ,value1:u});S.push(h);P.read("/ZSCM_CONTAINER_L4",{filters:S,urlParameters:{$top:"2000"},success:function(e,t){var a=[];console.log("hereee");console.log(e);console.log(e.results.length);for(let t=0;t<e.results.length;t++){var n=e.results[t].serialNumber;if(a.includes(n)==false){a.push(n)}else{if(n==e.results[t].serialNumber&&e.results[t].checkstatus=="Y"){e.results.splice(t,1);t-=1}else if(n==e.results[t-1].serialNumber&&e.results[t-1].checkstatus=="Y"){e.results.splice(t-1,1);if(t>1){t-=2}else if(t==1){t=0}}else if(t+1<e.results.length){if(n==e.results[t+1].serialNumber&&e.results[t+1].checkstatus=="Y"){e.results.splice(t+1,1)}}}}console.log(a);console.log(a.length);var s=0;for(let t=0;t<a.length;t++){var u=0;var p=0;var d=0;var m=e.results[t].materialText;var f=e.results[t].serialNumber;var v=e.results[t].materialNumber;var b=e.results[t].dayOwned;var P=new Date(e.results[t].lastRecievedDate);var S={year:"numeric",month:"long",day:"numeric"};var h=new Intl.DateTimeFormat("en-US",S).format(P);var O=h;var C=e.results[t].userStatustext;var x="";if(i!=""&&i!=null&&i!="FUM"){p+=1}else if(l!=""&&l!=null&&l!="FUM"){p+=1}else if(g!=""&&g!=null&&g!="FUM"){p+=1}else if(c!=""&&c!=null&&c!="FUM"){p+=1}if(C!=undefined){if(C.nodeValue!=undefined){C=C.nodeValue}}else{C=""}n=a[t];for(let t=0;t<e.results.length;t++){if(n==e.results[t].serialNumber&&e.results[t].userStatustext!=undefined){x+=e.results[t].userStatustext+" "}}for(let t=0;t<4;t++){for(let a=0;a<e.results.length;a++){if(n==e.results[a].serialNumber){var w=e.results[a].userStatCode;if(w!=undefined){if(w.nodeValue!=undefined){w=w.nodeValue}}else{w=""}if(w=="UNU"){d=1}if(w=="DPI"){if(t==0&&i!=""&&i!=null&&i!="FUM"){if(i==w||i=="FQ"){u+=1}}else if(t==1&&l!=""&&l!=null&&l!="FUM"){if(l==w||l=="FQ"){u+=1}}else if(t==2&&g!=""&&g!=null&&g!="FUM"){if(g==w||g=="FQ"){u+=1}}else if(t==3&&c!=""&&c!=null&&c!="FUM"){if(c==w||c=="FQ"){u+=1}}}else if(w=="FQ"){if(t==0&&i!=""&&i!=null&&i!="FUM"){if(i==w){u+=1}}else if(t==1&&l!=""&&l!=null&&l!="FUM"){if(l==w){u+=1}}else if(t==2&&g!=""&&g!=null&&g!="FUM"){if(g==w){u+=1}}else if(t==3&&c!=""&&c!=null&&c!="FUM"){console.log(c);if(c==w){u+=1}}}else if(w=="GP"){if(t==0&&i!=""&&i!=null&&i!="FUM"){if(i==w){u+=1}}else if(t==1&&l!=""&&l!=null&&l!="FUM"){if(l==w){u+=1}}else if(t==2&&g!=""&&g!=null&&g!="FUM"){if(g==w||g=="FUM"){u+=1}}else if(t==3&&c!=""&&c!=null&&c!="FUM"){console.log(c);if(c==w||c=="FUM"){u+=1}}}else if(w=="FUM"){if(t==0&&i!=""&&i!=null&&i!="FUM"){if(i=="GP"){u+=1}}else if(t==1&&l!=""&&l!=null&&l!="FUM"){if(l=="GP"){u+=1}}else if(t==2&&g!=""&&g!=null&&g!="FUM"){if(g=="GP"){u+=1}}else if(t==3&&c!=""&&c!=null&&c!="FUM"){console.log(c);if(c=="GP"){u+=1}}}}}}if(i==""&&l==""&&g==""&&c==""){u=1;p=1}if(u>0&&d!=1){if(s>=1){o+=","}o+='{"materialText":"'+m+'","serialNumber":"'+n+'","materialNumber":"'+v+'","dayOwned":"'+b+'","lastRecievedDate":"'+O+'","userStatustext":"'+x+'"}';s+=1}}o+="]}";if(r==1&&o.length>10){console.log("here");var D=JSON.parse(o);console.log(D);var F=new sap.ui.model.json.JSONModel;F.setDefaultBindingMode("OneWay");F.setData(D);console.log(M.getOwnerComponent().getModel("item"));M.getOwnerComponent().getModel("item").setData(D);console.log(M.getOwnerComponent().getModel("item"));M._DialogGenerate=sap.ui.xmlfragment("packingapp.packingapp.ext.fragment.CreateHUDialog",M);M.getView().addDependent(M._DialogGenerate);M._DialogGenerate.open()}},error:function(e){console.log(e);sap.m.MessageBox.error(e)}})}}.bind(this),error:function(e){sap.m.MessageBox.error(e)}});console.log(this.getOwnerComponent().getModel())}else if(x=="0005"){if(sap.ui.getCore().byId("OK")===undefined){var I=new sap.m.Button("OK",{text:"OK"})}else if(sap.ui.getCore().byId("OK")!=undefined){var I=sap.ui.getCore().byId("OK")}if(sap.ui.getCore().byId("Cancel")===undefined){var _=new sap.m.Button("Cancel",{text:"Cancel"})}else if(sap.ui.getCore().byId("Cancel")!=undefined){var _=sap.ui.getCore().byId("Cancel")}_.attachPress(function(e){if(sap.ui.getCore().byId("Dialog1")!=undefined){sap.ui.getCore().byId("Dialog1").close();sap.ui.getCore().byId("Dialog1").destroy()}});var y=new sap.m.Dialog("Dialog1",{title:"Select Seal Number",contentWidth:"20%",closeOnNavigation:true,buttons:[I,_],content:[new sap.m.Label({text:"Seal Number:",required:true}),new sap.m.Input({maxLength:8,id:"SealNumber"})]});y.addStyleClass("sapUiContentPadding");y.open();I.attachPress(function(e){var t=sap.ui.getCore().byId("SealNumber").getValue();if(sap.ui.getCore().byId("Dialog1")!=undefined){sap.ui.getCore().byId("Dialog1").close();sap.ui.getCore().byId("Dialog1").destroy()}var a=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PACKINGACTION_SRV_SRV");console.log(f);a.callFunction("/CreateHU",{method:"POST",urlParameters:{manOrder:O,batch:c,packMaterial:b,plant:u,packInst:f,product:S,sealNumber:t,serialNumber:"",storLocItem:p,auxMaterial:h,customer:o,packInstQuant:P},success:function(e,t){console.log(e);var a=e.Message;var r=e.Type;if(r=="S"){sap.m.MessageToast.show(a)}else{sap.m.MessageBox.error(a)}}.bind(this),error:function(e){console.log(e);sap.m.MessageBox.error(e)}})})}else{var j=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PACKINGACTION_SRV_SRV");console.log(f);j.callFunction("/CreateHU",{method:"POST",urlParameters:{manOrder:O,batch:c,packMaterial:b,plant:u,packInst:f,product:S,sealNumber:"",serialNumber:"",storLocItem:p,auxMaterial:h,customer:o,packInstQuant:P},success:function(e,t){var a=e.Message;var r=e.Type;if(r=="S"){console.log(a);sap.m.MessageToast.show(a)}else{sap.m.MessageBox.error(a)}},error:function(e){console.log(e);sap.m.MessageBox.error(e)}})}},createSample:function(e){var t="00000000000"+e.getSource().getParent().getParent().getBindingContext().getObject().orderNumber;t=t.substr(t.length-12);var a="000000000000000000"+e.getSource().getParent().getParent().getBindingContext().getObject().product;a=a.substr(a.length-18);var r=e.getSource().getParent().getParent().getBindingContext().getObject().plant;var n="/packingapplication/sap/opu/odata/sap/ZSCM_PACKAPP_SRV/ZSCM_I_SampleOperationVH_L1?$filter=prodorder eq '"+t+"'";var o='{"items":[';var s;var i;var l=this;var g=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PACKAPP_SRV");var u=new Array;var c=new sap.ui.model.Filter({path:"prodorder",operator:sap.ui.model.FilterOperator.EQ,value1:t});u.push(c);g.read("/ZSCM_I_SampleOperationVH_L1",{filters:u,success:function(e,t){console.log(e);for(let t=0;t<e.results.length;t++){s=e.results[t].activity;i=e.results[t].shortText;o+='{"operation":"'+s+'","operationText":"'+i+'"}';if(t+1<e.results.length){o+=","}}o+="]}";console.log(o);var a=JSON.parse(o);console.log(a);var r=new sap.ui.model.json.JSONModel;r.setDefaultBindingMode("OneWay");r.setData(a);console.log(l.getOwnerComponent().getModel("item1"));l.getOwnerComponent().getModel("item1").setData(a);console.log(l.getOwnerComponent().getModel("item1"));l._DialogGenerate=sap.ui.xmlfragment("packingapp.packingapp.ext.fragment.CreateSampleDialog",l);l.getView().addDependent(l._DialogGenerate);l._DialogGenerate.open()},error:function(e){console.log(e);sap.m.MessageBox.error(e)}})},sendToCoLos:function(e){var t="000000000000000000"+e.getSource().getParent().getParent().getBindingContext().getObject().product;t=t.substr(t.length-18);var a="00000000000"+e.getSource().getParent().getParent().getBindingContext().getObject().orderNumber;a=a.substr(a.length-12);var r=e.getSource().getParent().getParent().getBindingContext().getObject().plant;var n=e.getSource().getParent().getParent().getBindingContext().getObject().batch;var o=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PACKINGACTION_SRV_SRV");o.callFunction("/updateManuDate",{method:"POST",urlParameters:{manOrder:a,batch:n,plant:r,product:t},success:function(e,t){console.log(e);var a=e.Message;var r=e.Type;if(r=="S"){console.log(a);sap.m.MessageToast.show(a)}else{sap.m.MessageBox.error(a)}},error:function(e){console.log(e);sap.m.MessageBox.error(e)}})},addToExisting:function(e){this._DialogGenerate=sap.ui.xmlfragment("packingapp.packingapp.ext.fragment.AddToExistingDialog",this);this.getView().addDependent(this._DialogGenerate);this._DialogGenerate.open()},displyPackInst:function(e){var t=e.getSource().getParent().getParent().getBindingContext().getObject().packInstURL255;if(t!=""){console.log(t);window.open(t)}if(t==""){sap.m.MessageToast.show("There is no link for this packing instruction")}},packToOrder:function(e){var t=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().PackingInstructionsSO;var a=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().PackingInstDescSO;var r=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().PackingInstQuantSO;var n=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().packagingMaterialSO;var o=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().packagingMaterialDescriptionSO;var s=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().auxMaterialSO;var i=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().auxMaterialDescSO;var l=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().StackingPatternSO;var g=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().HeightSettingSO;var u=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().AlternateSO;var c=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().PackingInstructionKeySO;var p=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().packInstURLOpenDel;if(t==""||t==null){sap.m.MessageBox.error("No Packaging Instructions Associated With This Order",{title:"Error",onClose:null,styleClass:"",actions:sap.m.MessageBox.Action.CLOSE,emphasizedAction:null,initialFocus:null,textDirection:sap.ui.core.TextDirection.Inherit})}else{var d=sap.ui.getCore().getEventBus();var m={PackingInstructionsSO:t,PackingInstQuantSO:r,packagingMaterialSO:n,packagingMaterialDescriptionSO:o,auxMaterialSO:s,auxMaterialDescSO:i,PackingInstructionsKeySO:c,packInstURLOpenDel:p};d.publish("MyChannel","oSetPackToOrder",m)}},onActionCancel:function(){this._DialogGenerate.close();this._DialogGenerate.destroy();this.getView().removeDependent(this._DialogGenerate);this._DialogGenerate=null},onActionOKCreateHU:function(e){var t=e.getSource().getParent().getParent().getBindingContext().getObject().customer;var a=e.getSource().getParent().getParent().getBindingContext().getObject().packCustomerType;var r=e.getSource().getParent().getParent().getBindingContext().getObject().packStockType;var n=e.getSource().getParent().getParent().getBindingContext().getObject().PackingInstObj;var o=e.getSource().getParent().getParent().getBindingContext().getObject().packagingMaterialCustr;var s=e.getSource().getParent().getParent().getBindingContext().getObject().plant;var i=e.getSource().getParent().getParent().getBindingContext().getObject().batch;var l=e.getSource().getParent().getParent().getBindingContext().getObject().StorLoc;if(n==e.getSource().getParent().getParent().getBindingContext().getObject().packInstru){var g=e.getSource().getParent().getParent().getBindingContext().getObject().packInstructionsKey}else if(n==e.getSource().getParent().getParent().getBindingContext().getObject().PackingCustomerInstructions){var g=e.getSource().getParent().getParent().getBindingContext().getObject().packInstructionsCustKey}else{var g=e.getSource().getParent().getParent().getBindingContext().getObject().altPIKey}var u="000000000000000000"+e.getSource().getParent().getParent().getBindingContext().getObject().packagingMaterialObj;u=u.substr(u.length-18);var c=e.getSource().getParent().getParent().getBindingContext().getObject().PackingInstQuantObj;var p="000000000000000000"+e.getSource().getParent().getParent().getBindingContext().getObject().product;p=p.substr(p.length-18);var d="000000000000000000"+e.getSource().getParent().getParent().getBindingContext().getObject().auxPackMaterialObj;d=d.substr(d.length-18);var m="00000000000"+e.getSource().getParent().getParent().getBindingContext().getObject().orderNumber;m=m.substr(m.length-12);console.log(sap.ui.getCore());var f=sap.ui.getCore().byId("containerInput").getValue();var v=sap.ui.getCore().byId("sealNumberInput").getValue();if(f==""&&s=="2310"){sap.ui.getCore().byId("containerInput").setValueState(sap.ui.core.ValueState.Error)}else{var b=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PACKINGACTION_SRV_SRV");b.callFunction("/CreateHU",{method:"POST",urlParameters:{manOrder:m,batch:i,packMaterial:u,plant:s,packInst:g,product:p,sealNumber:v,serialNumber:f,storLocItem:l,auxMaterial:d,customer:t,packInstQuant:c},success:function(e,t){console.log(e);var a=e.Message;var r=e.Type;if(r=="S"){console.log(a);sap.m.MessageToast.show(a)}else{sap.m.MessageBox.error(a)}},error:function(e){console.log(e);sap.m.MessageBox.error(e)}});this._DialogGenerate.close();this._DialogGenerate.destroy();this.getView().removeDependent(this._DialogGenerate);this._DialogGenerate=null}},onActionOKCreateSample:function(e){var t="00000000000"+e.getSource().getParent().getParent().getBindingContext().getObject().orderNumber;t=t.substr(t.length-12);var a="000000000000000000"+e.getSource().getParent().getParent().getBindingContext().getObject().product;a=a.substr(a.length-18);var r=e.getSource().getParent().getParent().getBindingContext().getObject().plant;var n=sap.ui.getCore().byId("opNumInput").getValue();var o=sap.ui.getCore().byId("palletInput").getValue();var s=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PACKINGACTION_SRV_SRV");s.callFunction("/createSample",{method:"POST",urlParameters:{container:o,material:a,operationNumber:n,plant:r,palletID:"",order:t},success:function(e,t){console.log(e);var a=e.Message;var r=e.Type;if(r=="S"){console.log(a);sap.m.MessageToast.show(a)}else{sap.m.MessageBox.error(a)}},error:function(e){console.log(e);sap.m.MessageBox.error(e)}});this._DialogGenerate.close();this._DialogGenerate.destroy();this.getView().removeDependent(this._DialogGenerate);this._DialogGenerate=null},onActionOKAddToExisting:function(e){var t=e.getSource().getParent().getParent().getBindingContext().getObject().PackingInstObj;if(t==e.getSource().getParent().getParent().getBindingContext().getObject().packInstru){var a=e.getSource().getParent().getParent().getBindingContext().getObject().packInstructionsKey}else{var a=e.getSource().getParent().getParent().getBindingContext().getObject().packInstructionsCustKey}var r=e.getSource().getParent().getParent().getBindingContext().getObject().packagingMaterialCustr;var n="000000000000000000"+e.getSource().getParent().getParent().getBindingContext().getObject().packagingMaterialObj;var o=n.substr(n.length-18);var s=parseFloat(e.getSource().getParent().getParent().getBindingContext().getObject().PackingInstQuantObj);var i="000000000000000000"+e.getSource().getParent().getParent().getBindingContext().getObject().packagingMaterialObj;var o=i.substr(i.length-18);var l="000000000000000000"+e.getSource().getParent().getParent().getBindingContext().getObject().product;var g=l.substr(l.length-18);var u=e.getSource().getParent().getParent().getBindingContext().getObject().orderNumber;var c="00000000000"+e.getSource().getParent().getParent().getBindingContext().getObject().orderNumber;var p=c.substr(c.length-12);var d=e.getSource().getParent().getParent().getBindingContext().getObject().plant;var m=e.getSource().getParent().getParent().getBindingContext().getObject().customer;var f=e.getSource().getParent().getParent().getBindingContext().getObject().batch;var v=e.getSource().getParent().getParent().getBindingContext().getObject().StorLoc;var b="000000000000000000"+e.getSource().getParent().getParent().getBindingContext().getObject().auxPackMaterialObj;b=b.substr(b.length-18);var P=sap.ui.getCore().byId("containerInput").getValue();var S=sap.ui.getCore().byId("sealInput").getValue();var h=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PACKINGACTION_SRV_SRV");h.callFunction("/addToExistingHU",{method:"POST",urlParameters:{manOrder:p,batch:f,packMaterial:o,plant:d,packInst:a,product:g,serialNumber:P,storLocItem:v,packInstQuant:s,sealNumber:S,customer:m},success:function(e,t){console.log(e);var a=e.Message;var r=e.Type;if(r=="S"){console.log(a);sap.m.MessageToast.show(a)}else{sap.m.MessageBox.error(a)}},error:function(e){console.log(e);sap.m.MessageBox.error(e)}});this._DialogGenerate.close();this._DialogGenerate.destroy();this.getView().removeDependent(this._DialogGenerate);this._DialogGenerate=null},onValueHelpRequestedHUCont:function(){var e=new sap.ui.model.json.JSONModel;e.setDefaultBindingMode("OneWay");e.setData(this.getOwnerComponent().getModel("item").getData());console.log(e);console.log(this.getOwnerComponent().getModel("item").getData());this._oValueHelpDialog=sap.ui.xmlfragment("packingapp.packingapp.ext.fragment.ContValueHelpDialog",this);this.getView().addDependent(this._oValueHelpDialog);this._oBasicSearchField=new s;var t=this._oValueHelpDialog.getFilterBar();t.setFilterBarExpanded(false);t.setBasicSearch(this._oBasicSearchField);this._oValueHelpDialog.setRangeKeyFields([{label:"Serial Number",key:"serialNumber",type:"string",typeInstance:new r({},{maxLength:10})}]);this._oBasicSearchField.attachSearch(function(){t.search()});this._oValueHelpDialog.getTableAsync().then(function(t){console.log("here");t.setModel(e);if(t.bindRows){t.bindAggregation("rows",{path:"/items",events:{dataReceived:function(){oDialog.update()}}});t.addColumn(new c({label:"Serial Number",template:"serialNumber"}));t.addColumn(new c({label:"Material Number",template:"materialNumber"}));t.addColumn(new c({label:"Material Text",template:"materialText"}));t.addColumn(new c({label:"User Status",template:"userStatustext"}));t.addColumn(new c({label:"Last Recieved Date",template:"lastRecievedDate"}));t.addColumn(new c({label:"Days Owned",template:"dayOwned"}))}if(t.bindItems){t.bindAggregation("items",{path:"/items",template:new sap.m.ColumnListItem({type:"Active",unread:false,cells:[new sap.m.Label({text:"{materialNumber}",wrapping:true}),new sap.m.Label({text:"{materialText}",wrapping:true}),new sap.m.Label({text:"{serialNumber}",wrapping:true}),new sap.m.Label({text:"{userStatustext}",wrapping:true}),new sap.m.Label({text:"{lastRecievedDate}",wrapping:true}),new sap.m.Label({text:"{dayOwned}",wrapping:true})]}),events:{dataReceived:function(){oDialog.update()}}});t.addColumn(new p({header:new o({text:"Serial Number"})}));t.addColumn(new p({header:new o({text:"Material Number"})}));t.addColumn(new p({header:new o({text:"Material Text"})}));t.addColumn(new p({header:new o({text:"User Status"})}));t.addColumn(new p({header:new o({text:"Last Recieved Date"})}));t.addColumn(new p({header:new o({text:"Days Owned"})}))}});this._oValueHelpDialog.open()},onValueHelpRequestedSample:function(){var e=new sap.ui.model.json.JSONModel;e.setDefaultBindingMode("OneWay");e.setData(this.getOwnerComponent().getModel("item1").getData());console.log(e);console.log(this.getOwnerComponent().getModel("item1").getData());this._oValueHelpDialog=sap.ui.xmlfragment("packingapp.packingapp.ext.fragment.OperationValueHelpDialog",this);this.getView().addDependent(this._oValueHelpDialog);this._oBasicSearchField=new s;var t=this._oValueHelpDialog.getFilterBar();t.setFilterBarExpanded(false);t.setBasicSearch(this._oBasicSearchField);this._oValueHelpDialog.setRangeKeyFields([{label:"Operation Number",key:"operation",type:"string",typeInstance:new r({},{maxLength:10})}]);this._oBasicSearchField.attachSearch(function(){t.search()});this._oValueHelpDialog.getTableAsync().then(function(t){console.log("here");t.setModel(e);if(t.bindRows){t.bindAggregation("rows",{path:"/items",events:{dataReceived:function(){oDialog.update()}}});t.addColumn(new c({label:"Activity",template:"operation"}));t.addColumn(new c({label:"Operation Short Text",template:"operationText"}))}if(t.bindItems){t.bindAggregation("items",{path:"/items",template:new sap.m.ColumnListItem({type:"Active",unread:false,cells:[new sap.m.Label({text:"{operation}",wrapping:true}),new sap.m.Label({text:"{operationText}",wrapping:true})]}),events:{dataReceived:function(){oDialog.update()}}});t.addColumn(new p({header:new o({text:"Activity"})}));t.addColumn(new p({header:new o({text:"Operation Short Text"})}))}});this._oValueHelpDialog.open()},onValueHelpOkPress:function(e){var t=sap.ui.getCore().byId("containerInput");var a=e.getParameter("tokens")[0].getKey();t.setValue(a);this._oValueHelpDialog.close();this._oValueHelpDialog.destroy()},onValueHelpCancelPress:function(){this._oValueHelpDialog.close();this._oValueHelpDialog.destroy()},onValueHelpSampleOkPress:function(e){var t=sap.ui.getCore().byId("opNumInput");var a=e.getParameter("tokens")[0].getKey();t.setValue(a);this._oValueHelpDialog.close();this._oValueHelpDialog.destroy()},onFilterBarSearch:function(e){var t=e.getParameter("selectionSet");var a=this._oBasicSearchField.getValue();var r=t.reduce(function(e,t){if(t.getValue()){e.push(new l({path:t.getName(),operator:g.Contains,value1:t.getValue()}))}return e},[]);r.push(new l({filters:[new l({path:"serialNumber",operator:g.Contains,value1:a})],and:false}));this._filterTable(new l({filters:r,and:true}))},onFilterBarSearchSample:function(e){var t=e.getParameter("selectionSet");var a=this._oBasicSearchField.getValue();console.log(t);var r=t.reduce(function(e,t){if(t.getValue()){e.push(new l({path:t.getName(),operator:g.Contains,value1:t.getValue()}))}return e},[]);r.push(new l({filters:[new l({path:"operation",operator:g.Contains,value1:a})],and:false}));this._filterTable(new l({filters:r,and:true}))},_filterTable:function(e){var t=this._oValueHelpDialog;t.getTableAsync().then(function(a){if(a.bindRows){a.getBinding("rows").filter(e)}if(a.bindItems){a.getBinding("items").filter(e)}t.update()})}}});
//# sourceMappingURL=ObjectPageExt.controller.js.map